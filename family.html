<!DOCTYPE html>
<html lang="en">
<head>
  <title>Tan Family Tree</title>
  <meta charset="utf-8">
  <meta name="description" content="Genealogy of the Tan Clan">
  <meta name="keywords" content="Tan,Tam,Family,Family Tree,Clan,Genealogy">
  <meta name="author" content="Justin Tam">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body>
  <script src="https://unpkg.com/gojs@2.3.16/release/go.js"></script>
  <div class="p-4 w-full">
    <script id="code">
    function init() {

      const $ = go.GraphObject.make;  // for conciseness in defining templates

      familyTree =
        new go.Diagram("divFamilyTree",  // must be the ID or reference to div
          {
            allowCopy: false,
            layout:  // create a TreeLayout for the family tree
              $(go.TreeLayout,
                { angle: 90, layerStyle: go.TreeLayout.LayerUniform, nodeSpacing: 25 })
          });

      var bluegrad = $(go.Brush, "Linear", { 0: "rgb(60, 204, 254)", 1: "rgb(70, 172, 254)" });
      var pinkgrad = $(go.Brush, "Linear", { 0: "rgb(255, 192, 203)", 1: "rgb(255, 142, 203)" });

      // Set up a Part as a legend, and place it directly on the diagram
      familyTree.add(
        $(go.Part, "Table",
          { position: new go.Point(-300, 50), selectable: false },
          $(go.TextBlock, "Key",
            { row: 0, font: "bold 10pt Helvetica, Arial, sans-serif" }),  // end row 0
          $(go.Panel, "Horizontal",
            { row: 1, alignment: go.Spot.Left },
            $(go.Shape, "Rectangle",
              { desiredSize: new go.Size(30, 30), fill: bluegrad, margin: 6 }),
            $(go.TextBlock, "Males",
              { font: "bold 10pt Helvetica, bold Arial, sans-serif" })
          ),  // end row 1
          $(go.Panel, "Horizontal",
            { row: 2, alignment: go.Spot.Left },
            $(go.Shape, "Rectangle",
              { desiredSize: new go.Size(30, 30), fill: pinkgrad, margin: 6 }),
            $(go.TextBlock, "Females",
              { font: "bold 10pt Helvetica, bold Arial, sans-serif" })
          )  // end row 2
        ));

      // get tooltip text from the object's data
      function tooltipText(person) {
        var str = "";
        if (person.description !== "") str += person.description;
        if (person.fullTitle !== "") {
	  if (person.description !== "") str += "\n\n";
	  str += person.fullTitle;
	}
        return str;
      }

      // define tooltips for nodes
      var tooltiptemplate =
        $("ToolTip",
          { "Border.fill": "whitesmoke", "Border.stroke": "black" },
          $(go.TextBlock,
            {
              font: "bold 10pt Helvetica, bold Arial, sans-serif",
              wrap: go.TextBlock.WrapFit,
              width: 250,
              margin: 6
            },
            new go.Binding("text", "", tooltipText))
        );

      // define Converters to be used for Bindings
      function genderBrushConverter(gender) {
        if (gender === "M") return bluegrad;
        if (gender === "F") return pinkgrad;
        return "orange";
      }

      // get image from the object's data
      function avatarImage(person) {
        var str = "https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_640.png";
		if (person.image !== undefined) str = person.image;
        return str;
      }

      // get lifespan text from the object's data
      function lifespanText(person) {
        var str = "(" + person.birthYear + " - " + person.deathYear + ")";
        return str;
      }

      // replace the default Node template in the nodeTemplateMap
      familyTree.nodeTemplate =
        $(go.Node, "Auto",
          { deletable: false, toolTip: tooltiptemplate },
          new go.Binding("text", "name"),
          $(go.Shape, "Rectangle",
            {
              fill: "orange",
              stroke: "black",
              stretch: go.GraphObject.Fill,
              alignment: go.Spot.Center
            },
            new go.Binding("fill", "gender", genderBrushConverter)),
          $(go.Panel, "Vertical",
	    $(go.Picture,
              {
		alignment: go.Spot.Center,
		width: 60,
		height: 60,
		margin: 6
              },
              new go.Binding("source", avatarImage)),
            $(go.TextBlock,
              {
                font: "bold 10pt Helvetica, bold Arial, sans-serif",
                alignment: go.Spot.Center,
                margin: 6
              },
              new go.Binding("text", "name")),
            $(go.TextBlock,
              {
                font: "bold 10pt Helvetica, bold Arial, sans-serif",
                alignment: go.Spot.Center,
                margin: 6
              },
              new go.Binding("text", "chineseName")),
            $(go.TextBlock,
              {
                font: "bold 10pt Helvetica, bold Arial, sans-serif",
                alignment: go.Spot.Center,
                margin: 6
              },
              new go.Binding("text", lifespanText))
          )
        );

      // define the Link template
      familyTree.linkTemplate =
        $(go.Link,  // the whole link panel
          { routing: go.Link.Orthogonal, corner: 5, selectable: false },
          $(go.Shape));  // the default black link shape

      // here's the family data
      var nodeDataArray = [
        { key: "0", name: "Tan Hongzhi", gender: "M", chineseName: "譚宏帙", styleName: "崇紀", artName: "虔翁", birthYear: "901", deathYear: "974", fullTitle: "Served successively as the crown prince's grand protector (太子太保), Minister of the Ministry of Personnel (吏部尚書), Vice Minister of the Metropolitan Procuratorate (都察院左右侍郎), Left and Right Censor (左右禦吏), and Governor of Jiangxi (江西總制). Achieved Jinshi (進士).", description: "Born during the Five Dynasties period, Hongzhi lived in Xijun Village, Qianzhou, Jiangxi (now Ningdu, Jiangxi). In the first year of Jianlong of the Song Dynasty (960), due to local unrest, he moved to Shashui Village, Zhujili, Baochang County, Nanxiong to avoid chaos. In the third year of Jianlong of the Song Dynasty (962), he returned to Qianzhou after peace. Hong Gui gave birth to two sons, Tan Hong and Tan Han.", image: "https://p3-sdbk2-media.byteimg.com/tos-cn-i-xv4ileqgde/2c9ac1a536c74c7fa588e5f99fca4b33~tplv-xv4ileqgde-resize-w:750.image" },
        { key: "1", parent: "0", name: "Tan Hong", gender: "M", chineseName: "譚洪", styleName: "少參", artName: "叠山", birthYear: "930", deathYear: "1000", fullTitle: "Jinshi (進士)", description: "First son of Tan Honzhi. Appointed as a Confucian scholar (jinshi) in Guangdong in the first year of Zhidao in the Song Dynasty (955) and moved to Shuangqiao Village in Panyu." },
        { key: "2", parent: "1", name: "Tan Jiayan", gender: "M", chineseName: "譚嘉言", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "Jinshi (進士)", description: "Only son of Tan Hong. Appointed as Confucian scholar (jinshi) in Guangdong." },
        { key: "3", parent: "2", name: "Tan Wen", gender: "M", chineseName: "譚文", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Jiayan" },
        { key: "4", parent: "3", name: "Tan Weiri", gender: "M", chineseName: "譚惟日", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "First son of Tan Wen" },
	{ key: "4a", parent: "3", name: "Tan Weiyue", gender: "M", chineseName: "譚惟月", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Second son of Tan Wen" },
        { key: "5", parent: "4a", name: "Tan Bing", gender: "M", chineseName: "譚炳", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Weiyue" },
        { key: "6", parent: "5", name: "Tan Qianyi", gender: "M", chineseName: "譚千一", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Bing" },
        { key: "7", parent: "6", name: "Tan Shida", gender: "M", chineseName: "譚仕達", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Qianyi" },
        { key: "8", parent: "7", name: "Tan Taibo", gender: "M", chineseName: "譚泰伯", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "First son of Tan Shida." },	
	{ key: "8a", parent: "7", name: "Tan Zhongbo", gender: "M", chineseName: "譚仲伯", styleName: "紹康", artName: "虔源", birthYear: "1265", deathYear: "1300", fullTitle: "", description: "Second son of Tan Shida. Moved to Yakou village - progenitor of the Yakou branch of the Tan family." },
	{ key: "9", parent: "8a", name: "Tan Xishan", gender: "M", chineseName: "譚溪山", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Zhongbo." },

	{ key: "1a", parent: "0", name: "Tan Han", gender: "M", chineseName: "譚瀚", styleName: "文江", artName: "美水", birthYear: "?", deathYear: "?", fullTitle: "", description: "Second son of Tan Hongzhi. Moved from Qianzhou to Nanxiong Zhuji Lane" },
        { key: "2a", parent: "1a", name: "Tan Bocang", gender: "M", chineseName: "伯倉", styleName: "", artName: "", birthYear: "?", deathYear: "?", fullTitle: "", description: "Only son of Tan Han." }

      ];

      // create the model for the family tree
      familyTree.model = new go.TreeModel(nodeDataArray);
    }
    window.addEventListener('DOMContentLoaded', init);
  </script>
  
  <div id="divFamilyTree" style="background-color: white; border: solid 1px black; width: 97vw; height: 97vh; margin: 0.5vh 0.5vw;"></div>

</body>
</html>
